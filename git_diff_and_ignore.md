# Git 差分確認と無視設定まとめ
## 1. git diff
変更した内容の差分を確認するときに使う。
```bash
git diff # ステージに上げていない変更の差分を表示
git diff --staged # ステージに上げた変更の差分を表示
```

## 2. gitignore
Gitに管理させたくないファイルやフォルダを指定するファイル。
- 例：ビルドファイルや環境設定ファイル、ログファイルなど
- .gitignoreに書いたパターンにマッチするファイルはGitの管理対象外になる。
```bash
# ビルドファイルを無視する
/build/
# ログファイルを無視する
*.log
# OS固有のファイルを無視する
.DS_Store
Thumbs.db
```

## 3. すでにGitで管理されているファイルを除外する方法
.gitignoreに追加しても、すでにGitの管理下にあるファイルは無視されない。
そのため以下の手順で一度ステージから外す必要がある。
```bash
# キャッシュから除外（Gitの追跡を外す）
git rm --cached ファイル名
# 例：logs/app.logを除外する
git commit -m "Stop tracking app.log"
# その後は.gitignoreで無視されるようになる
```

## 4. `.gitignore`の効かないケースと対処法
### 管理下にあるファイルには無効
`.gitignore`に記述しても、すでにGitの管理下にあるファイルは無視されない。

#### 対処法
```bash
git rm --cached ファイル名
```
その後.gitignoreに追記する。
例
```bash
git rm --cached debug.log
echo "debug.log" >> .gitignore
```

## 5. .gitignoreの書き方の注意点
| 記述例            | 意味                                                           |
| ---------------- | -------------------------------------------------------------- |
| `/log`           | ルート直下の `log` ディレクトリのみ無視                           |
| `log/`           | すべての `log` ディレクトリを無視（再帰的）                       |
| `*.tmp`          | `.tmp` 拡張子を持つすべてのファイルを無視                         |
| `!important.txt` | それまでの無視ルールに関わらず `important.txt` は Git で追跡対象に |

## 6. .git/info/excludeの使い方（個人用の.gitignore）
チーム共有せずにローカルだけどファイルを無視したい場合は、.gitignoreの代わりに以下のファイルを編集する。
```bash
.git/info/exclude
```
例：
```bash
# ローカルでしか使わないファイルをここに記載
my_local_notes.txt
```

## 7. 便利な補助コマンド
### 無視されているファイルの一覧を表示
```bash
git status --ignored
```
### .gitignoreの効果を調べる（トラブル時）
```bash
git check-ignore -v ファイル名
```
このコマンドで、どの.gitignoreの何行目で無視されているかがわかる。

## 8. よくあるトラブルと対策
| 症状                                      | 原因と対策                                |
| ----------------------------------------- | ---------------------------------------- |
| `.gitignore` に書いたのに追跡され続けている  | 既に Git 管理下。`git rm --cached` が必要 |
| `.gitignore` の無視が効かない              | パスの書き方ミスや、ワイルドカードの誤使用   |
| 他人の開発環境のゴミファイルが追跡されている  | `.gitignore` をプロジェクトに共有する      |
| 個人の設定ファイルを共有したくない           | `.git/info/exclude` を使う                |